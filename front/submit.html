<html>

<head>
  <title>mthon algorithm submission</title>
  <style>
    .logo { z-index: 9999; bottom:0; right:0; position: absolute; margin-right:1em; margin-bottom: 1em;}
  </style>
</head>

<body>
  <div class="logo"><img src="assets/img/mthon-logo.png"></div>
  <div id="upload-area">
    <form id="uploadForm" enctype="multipart/form-data" action="/api/algo" method="post" style="background-color: white;">
      <p style="display: inline-block; margin: 0 3em 0 0; padding: 0;">Upload your algorithm here</p>
      <input type="file" name="algo" />
      <!-- <input type="text" name="group" placeholder="the name of your group"></input> -->
      <select id="teams" name="chosenTeam"></select>
      <input type="submit" value="Submit" name="algo">
    </form>
  </div>

  <div id="after-submission">
    <p>You did it!</p>
    <p>Your results will soon appear here</p>

    <p>Pass the anticheat: <span id="anticheat"></span></p>
    <p>10K path distance: <span id="length"></span></p>
    <p>10K path speed: <span id="speed"></span></p>
  </div>
</body>
<script src="http://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery.form/3.51/jquery.form.min.js"></script>

<script>
  $(document).ready(function() {
    $('#after-submission').hide();
    $.get('/api/teams', function(res) {
      res.forEach(function(t) {
        var opt = $('<option value="'+t._id+'">'+t.name+'</option>');
        $('#teams').append(opt);
      });
    });

    $('#uploadForm').submit(function() {
      $(this).ajaxSubmit({
        error: function(xhr) {
          status('Error: ' + xhr.status);
        },
        success: function(response) {
          $('#anticheat').html(response.anticheat ? 'Yes' : 'No');
          $('#length').html(response.distance);
          $('#speed').html(response.speed + ' seconds');
          console.log(response);
          $('#upload-area').slideUp();
          $('#after-submission').slideDown();
        }
      });
      return false;
    });
  });
</script>
</html>
